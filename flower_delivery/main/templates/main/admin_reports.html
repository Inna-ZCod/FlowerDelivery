{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4">üìä –û—Ç—á—ë—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</h4>
        <p class="fs-5"><strong>{{ total_orders }}</strong></p>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–ó–∞–∫–∞–∑—ã –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h4>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                </tr>
            </thead>
            <tbody>
                {% for status, count in orders_by_status.items %}
                <tr>
                    <td>{{ status }}</td>
                    <td>{{ count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</h4>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</th>
                </tr>
            </thead>
            <tbody>
                {% for user in user_orders_count %}
                <tr>
                    <td>{{ user.user__username }}</td>
                    <td>{{ user.total }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–∫–∞–∑–æ–≤</h4>
        <p class="fs-5"><strong>{{ average_order_value|floatformat:2 }} —Ä—É–±.</strong></p>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–í—ã—Ä—É—á–∫–∞</h4>
        <p><strong>–ó–∞ —Å–µ–≥–æ–¥–Ω—è:</strong> {{ revenue_today|floatformat:2 }} —Ä—É–±.</p>
        <p><strong>–ó–∞ –Ω–µ–¥–µ–ª—é:</strong> {{ revenue_week|floatformat:2 }} —Ä—É–±.</p>
        <p><strong>–ó–∞ –º–µ—Å—è—Ü:</strong> {{ revenue_month|floatformat:2 }} —Ä—É–±.</p>
    </div>

    <div class="card shadow-sm p-4 mb-4">
        <h4>–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±—É–∫–µ—Ç—ã</h4>
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–ë—É–∫–µ—Ç</th>
                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤</th>
                </tr>
            </thead>
            <tbody>
                {% for bouquet in popular_bouquets %}
                <tr>
                    <td>{{ bouquet.products__name }}</td>
                    <td>{{ bouquet.total }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="text-center mt-4">
        <a href="{% url 'download_report' %}" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç</a>
    </div>
</div>
{% endblock %}